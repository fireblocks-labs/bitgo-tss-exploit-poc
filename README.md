# BitGo TSS Exploit PoCs


## ECDSA
### [First ECDSA Exploit](ecdsa-poc-diff.patch)
This exploit is described [here](https://www.fireblocks.com/blog/bitgo-wallet-zero-proof-vulnerability/)  

**Impact: full key exfiltration within 1 signature**

<p align="center">
  <img src="/ecdsa-poc-preview.gif" />
</p>

```
git clone https://github.com/BitGo/BitGoJS.git BitGoJS-ecdsa
cd BitGoJS-ecdsa
git checkout 9bc367c47efd5998659123ba78f63599b071c565
git apply ../ecdsa-poc-diff.patch
yarn install
cd modules/account-lib
yarn run unit-test
```


### [Second ECDSA Exploit](ecdsa-poc-diff-round-2.patch)
After receiving our report, BitGo released a patch that fixed the issue by adding a range proof, but lacked another necessary proof for the paillier key well-formedness, which we then used to exploit the implementation again  

**Impact: full key exfiltration within 16 signatures**
```
git clone --branch bitgo@18.0.1 https://github.com/BitGo/BitGoJS.git BitGoJS-ecdsa-2
cd BitGoJS-ecdsa-2
git apply ../ecdsa-poc-2-diff.patch
yarn install
cd modules/account-lib
yarn run unit-test
```
